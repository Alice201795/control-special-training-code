C51 COMPILER V9.01   EXTERNAL_INTERRUPTS_LEVEL_TRIGGER                                     11/17/2017 18:40:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE EXTERNAL_INTERRUPTS_LEVEL_TRIGGER
OBJECT MODULE PLACED IN External_interrupts_level_trigger.OBJ
COMPILER INVOKED BY: D:\Keil_v4\C51\BIN\C51.EXE External_interrupts_level_trigger.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*
   2           *****************************************************************************************
   3           *      实 验 名 称:外部中断0的应用
   4           *  实 验 平 台：清翔电子 QX-MCS51开发板
   5           *      创 建 作 者：miki
   6           *  功 能 说 明：1.测试外部中断低电平触发方式的效果,主函数里数码管循环显示0-9，
   7           *                               当外部中断0低电平触发时（P3^2），进入中断服务函数让LED以500ms闪烁
   8           *                               2.测试外部中断下降沿触发方式的效果,主函数里数码管循环显示0-9，
   9           *                               当外部中断1下降沿触发时（P3^3），进入中断服务函数让蜂鸣器以500ms发声
  10           *  github 地 址：
  11           *      创 建 日 期：2017-11-14
  12           *****************************************************************************************
  13           */
  14          
  15          /************************************* 包含头文件 ***************************************/
  16          #include <reg52.h>
  17          
  18          /**************************************** 宏定义 *****************************************/
  19          #define uint unsigned int 
  20          #define uchar unsigned char
  21          
  22          //typedef unsigned int uint;
  23          //typedef unsigned char uchar;
  24          
  25          /*************************************** IO口定义 ****************************************/
  26          sbit DULA_IO = P2^6;
  27          sbit WELA_IO = P2^7;
  28          sbit BEEP_IO = P2^3;    // 低电平驱动
  29          
  30          /************************************* 全局变量定义 **************************************/
  31          uchar code GlobalDisplayTable[] = 
  32                  {0x3f,0x06,0x5b,0x4f,0x66,
  33                   0x6d,0x7d,0x07,0x7f,0x6f};     /* 段选，选择要显示的数字 */
  34          
  35          /*************************************** 函数声明 ****************************************/
  36          void delayMs(uint xms);
  37          void externalInterrupt0Init(void);
  38          void externalInterrupt1Init(void);
  39          /*
  40           *****************************************************************************************
  41           * 函数名称：main
  42           * 函数功能：主函数，整个程序入口
  43           * 输入参数：无
  44           * 输出参数：无
  45           * 其他说明：无
  46           ******************************************************************************************
  47           */
  48          void main(void)
  49          {
  50   1              uchar num;
  51   1          externalInterrupt0Init();
  52   1              externalInterrupt1Init();
  53   1      
  54   1          while (1)
  55   1          {
C51 COMPILER V9.01   EXTERNAL_INTERRUPTS_LEVEL_TRIGGER                                     11/17/2017 18:40:42 PAGE 2   

  56   2              for (num=0;num<10;num++)
  57   2              {
  58   3                      DULA_IO = 1;
  59   3                              P0 = GlobalDisplayTable[num];
  60   3                              DULA_IO = 0;
  61   3              
  62   3                              P0 = 0xff;
  63   3                              WELA_IO = 1;
  64   3              
  65   3                              P0 = 0x00;
  66   3                              WELA_IO = 0;
  67   3      
  68   3                              P1 = 0xff;
  69   3      
  70   3                              delayMs(1000);
  71   3              }
  72   2          }
  73   1      }
  74          
  75          /*
  76           *****************************************************************************************
  77           * 函数名称：externalInterrupt0Handler
  78           * 函数功能：外部中断0中断服务函数
  79           * 输入参数：无
  80           * 输出参数：无
  81           * 其他说明：无
  82           ******************************************************************************************
  83           */
  84          void externalInterrupt0Handler(void) interrupt 0
  85          {
  86   1          P1 = 0xff;
  87   1          delayMs(500);
  88   1          P1 = 0x00;
  89   1          delayMs(500); 
  90   1      }
  91          
  92          /*
  93           *****************************************************************************************
  94           * 函数名称：externalInterrupt0Handler
  95           * 函数功能：外部中断1中断服务函数
  96           * 输入参数：无
  97           * 输出参数：无
  98           * 其他说明：无
  99           ******************************************************************************************
 100           */
 101          void externalInterrupt1Handler(void) interrupt 2
 102          {
 103   1          BEEP_IO = 0;
 104   1          delayMs(500);
 105   1          BEEP_IO = 1;
 106   1          delayMs(500); 
 107   1      }
 108          
 109          /*
 110           *****************************************************************************************
 111           * 函数名称：delayMs
 112           * 函数功能：实现毫秒级的延时
 113           * 输入参数：xms：需要延时时间
 114           * 输出参数：无
 115           * 其他说明：无
 116           ******************************************************************************************
 117           */
C51 COMPILER V9.01   EXTERNAL_INTERRUPTS_LEVEL_TRIGGER                                     11/17/2017 18:40:42 PAGE 3   

 118          void delayMs(uint xms)
 119          {
 120   1          uint x,y;
 121   1          for (x=xms;x>0;x--)
 122   1              for (y=114;y>0;y--);
 123   1      }
 124          
 125          /*
 126           *****************************************************************************************
 127           * 函数名称：externalInterrupt0Init
 128           * 函数功能：外部中断0中断初始化
 129           * 输入参数：无
 130           * 输出参数：无
 131           * 其他说明：无
 132           ******************************************************************************************
 133           */
 134          void externalInterrupt0Init(void)
 135          {
 136   1          EX0 = 1;   // 开启外部中断 0 ,P3.2选通
 137   1          IT0 = 0;   // 设置成电平触发（低电平）
 138   1          EA = 1;    // 开启总中断
 139   1      }
 140          
 141          /*
 142           *****************************************************************************************
 143           * 函数名称：externalInterrupt1Init
 144           * 函数功能：外部中断1中断初始化
 145           * 输入参数：无
 146           * 输出参数：无
 147           * 其他说明：无
 148           ******************************************************************************************
 149           */
 150          void externalInterrupt1Init(void)
 151          {
 152   1          EX1 = 1;   // 开启外部中断 0 ,P3.3选通
 153   1          IT1 = 1;   // 设置成边沿触发（下降沿）
 154   1          EA = 1;    // 开启总中断
 155   1      }
 156          
 157          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    234    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
